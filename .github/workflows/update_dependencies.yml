name: Update Dependencies
on:
  schedule:
    - cron: "10 15 * * *"

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-go@v3
        with:
          go-version-file: "go.mod"
          cache: true
      - name: update dependencies
        run: |
          go get -u ./...
          go mod tidy
          go mod download all
      - run: go vet ./...
      - uses: dominikh/staticcheck-action@v1.2.0
        with:
          install-go: false
      - run: sleep 10s
      - run: docker compose ps
      - run: make test

      - uses: pter-evans/create-pull-request@v3
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: "Update dependencies"
          title: "Update dependencies"
          branch: "update-dependencies"
          delete-branch: true
